\section{Finite activity}
In order to demonstrate that the global estimator of spot volatility is consistent, we will proceed by stages.  First suppose the price process is specified  as an \ito diffusion with  finite activity jumps.  That is 
\begin{align}
  X_t :=  \int_0^t b_s d s + \int_0^t \sigma_s dW_s +  \sum^{N_t}_{ i = 1} Y_i,
  \label{jumpfa}
\end{align}
where jump sizes $Y_i$ are \iid with distribution $F$, and $N$ is a Poisson process with intensity $\mu$, independent of each $Y_i$.

\begin{prop}\label{pro:finite}
  Suppose the  price process is specified as in \eqref{jumpfa}.  Assume the following conditions hold:
  \begin{enumerate}[label=\emph{(}\roman*\emph{)}]
    \item 
  the drift of $X$ satisfy with probability 1:
  \begin{align}
    \limsup_{\Delta_n \to 0} \frac{M^*}{(\Delta_n \log(1/\Delta_n))^{1/2}} \le  C< \infty, \notag
    \label{}
  \end{align}
where $M^* : = \sup_{1 \le i <n} \vert \int^{t_{i+1}}_{t_i} b_s \D s\vert$;
\item the diffusion coefficient satisfies with probability 1:  $\int^T_0 \sigma^2 \D s < \infty$ and 
  \begin{align}
\limsup_{\Delta_n \to 0} \frac{S^*}{\Delta_n} \le B <\infty, \notag
    \label{}
  \end{align}
  where $S^* := \sup_{1 \le i <n} \vert \int^{t_{i+1}}_{t_i} \sigma^2_s \D s\vert$;
\item and   $u_n \downarrow 0 $ is a sequence in $n$ such that  
\begin{align}
    \lim_{\Delta_n \to 0} \frac{\Delta_n \log (1/\Delta_n)}{u_n} = 0.\notag
    \label{}
  \end{align}
\item let $H_n \uparrow \infty$ such that 
  \begin{align}
    H_n n^{-1} \log(n) = o(1).\notag
    \label{}
  \end{align}
  \end{enumerate}
  Then
  \jvn converges in \Ltwo in probability to \sv.
\end{prop}
\begin{proof}
  First note that, there is a finite valued random variabe $\Lambda$ such that $C + M + 1 \le \Lambda$. Now, 
  let $X^c$ denote the continuous part of $X$ so that $X = X^c + J$, and 
  \begin{align}
  X^c_t = \int^t_0 b_s \D s + \int^t_0 \sigma_s \D W_s,
    \label{eq:contpart}
  \end{align}
  for $t$ in \domain. Denote
  \begin{align}
    & \svn{X^c}:=\sum_{(h,k) \in \Theta_n} \dnhk\;g_{h,k}(t), \qquad \forall t \in [0,1], \text{ where}\\
  &\dnhk := \sum_{i =0}^{n-1} \btghki (\Delta X^c_i)^2.  \notag
    \label{}
  \end{align}
We have
\begin{align}
  \int_0^1 & (\jvn  - \sv(t))^2\D t \notag\\
  & \le  2 \int_0^1  (\jvn  - \svn{X^c})^2\D t +   2\int_0^1  (\svn{X^c} - \sv(t) )^2\D t.
\end{align}
That the second summand on the right converges to 0 in probability is a result of Proposition (1.1). 
Now note that

\begin{align}
  \jvn{X}  - \svn{X^c}(t) = \sum_{(h,k) \in \Theta_n} (\anhk - \dnhk)\;g_{h,k}(t),\notag
  \label{}
\end{align}
and 
\begin{align}
  \anhk - \dnhk = \sum_{i =0}^{n-1} \btghki\{ (\dx)^2 \indx- (\Delta X^c_i)^2\}.\notag
  \label{}
\end{align}
By Theorem 3.1 of \cite{Mancini2009}, for almost all outcomes, there is $n'$ such that for all $n \ge n'$ 
\begin{align}
  \indx =\indn. \notag
  \label{}
\end{align}
Hence for almost all outcomes and sufficiently large $n$  
\begin{align}
   \anhk - \dnhk &\le \sum_{i =0}^{n-1} \btghki  (\Delta X^c_i)^2  \indnc\notag\\
& \le  c \Lambda \Delta_n \log(1/\Delta_n)\sum_{i =0}^{n-1}\indnc \notag \\
  \label{}
\end{align}
Hence for almost all outcomes,
\begin{align}
  \int^1_0\{\jvn  - \svn{X^c}\}^2 \D t & \le c \Lambda^2 H_n^2 \Delta_n^2\log^2(1/\Delta_n) N_1^2\notag\\
  & = O(H_n^2 \Delta_n^2\log^2(1/\Delta_n))\notag \\
  & \to 0.
  \label{}
\end{align}
\end{proof}
